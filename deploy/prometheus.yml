# SPDX-License-Identifier: PMPL-1.0-or-later
# Prometheus configuration for hypatia

global:
  scrape_interval: 15s
  evaluation_interval: 15s
  external_labels:
    monitor: 'hypatia'

rule_files:
  # - "alerts.yml"

scrape_configs:
  # Registry service metrics
  - job_name: 'registry'
    static_configs:
      - targets: ['registry:8080']
    metrics_path: /metrics
    scrape_interval: 10s

  # Adapter service metrics
  - job_name: 'adapter'
    static_configs:
      - targets: ['adapter:8081']
    metrics_path: /metrics
    scrape_interval: 10s

  # ArangoDB metrics
  - job_name: 'arangodb'
    static_configs:
      - targets: ['arangodb:8529']
    metrics_path: /_admin/metrics/v2
    scrape_interval: 30s
    basic_auth:
      username: root
      password_file: /etc/prometheus/arangodb_password

  # Dragonfly metrics (Redis-compatible)
  - job_name: 'dragonfly'
    static_configs:
      - targets: ['dragonfly:6379']
    metrics_path: /metrics
    scrape_interval: 10s

  # Prometheus self-monitoring
  - job_name: 'prometheus'
    static_configs:
      - targets: ['localhost:9090']
